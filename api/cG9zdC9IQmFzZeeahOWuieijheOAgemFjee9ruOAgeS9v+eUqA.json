{"title":"HBase的安装、配置、使用","date":"2019-01-02T02:22:58.000Z","slug":"HBase的安装、配置、使用","comments":true,"tags":["HBase"],"updated":"2019-05-11T17:30:01.307Z","content":"<h3 id=\"下载\">下载<a href=\"post/HBase的安装、配置、使用#下载\"></a></h3><p>进入<a href=\"https://hbase.apache.org/downloads.html\" target=\"_blank\" rel=\"noopener\">hbase下载页面</a>，选择与hadoop版本相兼容的hbase版本。在<a href=\"http://hbase.apache.org/book.html#configuration\" target=\"_blank\" rel=\"noopener\">这个页面</a>使用ctrl+f搜索”S”, 然后下面有一个表就是hbase与hadoop版本对应关系：</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/8066b06700f038fce195b2bcb86fc941c3f.jpg\" alt data-zoomable></p></div>\n<p>我这里使用的hadoop版本是2.8.5，使用的hbase版本是2.1.1。</p>\n<p>新建一个/usr/hbase目录，然后下载hbase。</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/13097e57f770603c2fdbd6153a4c38f6f09.jpg\" alt data-zoomable></p></div>\n<h3 id=\"安装\">安装<a href=\"post/HBase的安装、配置、使用#安装\"></a></h3><p>使用<code>tar xzvf hbase-XXX</code>命令解压hbase的包。解压完后，进入到解压好的hbase目录中，编辑<code>conf/hbase-site.xml</code>,该文件时主要的hbase配置文件，配置hbase的数据存储目录，这个配置文件中，在官方文档提及到</p>\n<blockquote>\n<p>You do not need to create the HBase data directory. HBase will do this for you. If you create the directory, HBase will attempt to do a migration, which is not what you want.</p>\n</blockquote>\n<p>大概意思是，我们不需要去创建hbase的数据目录，hbase会自己建一个目录来保存数据，如果我们自定义了目录，那么hbase把数据进行迁移过来，这会导致性能以及时间上的一些损耗。</p>\n<h3 id=\"配置\">配置<a href=\"post/HBase的安装、配置、使用#配置\"></a></h3><h4 id=\"配置JAVA-HOME\">配置JAVA_HOME<a href=\"post/HBase的安装、配置、使用#配置JAVA-HOME\"></a></h4><p>首先<a href=\"http://note.youdao.com/noteshare?id=d4c543d277e2a50ca580a96d42eb5cd7\" target=\"_blank\" rel=\"noopener\">找到java的安装路径</a>。然后使用<code>vim /etc/profile</code>命令打开profile文件，然后指定JAVA_HOME:</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/ef4dab3c1eef66e44c0f2ec81a1a02cae1c.jpg\" alt data-zoomable></p></div>\n<h4 id=\"配置hbase-site-xml\">配置hbase-site.xml<a href=\"post/HBase的安装、配置、使用#配置hbase-site-xml\"></a></h4><p>因为我之前已经安装了hadoop，已经有hdfs了，所以，这里的<code>hbase.rootdir</code>配置就要指向我的hadoop的hdfs目录，我是配置的core-site.xml中<code>fs.defaultFS</code>配置：</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/ef3f04fb0dbe34ce8ebb156269a63efed5c.jpg\" alt data-zoomable></p></div>\n<p>我的hbase-site.xml配置如下：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.rootdir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://localhost:9000/hbase<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.zookeeper.property.dataDir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/hadoop/hbase/zookeeper<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.unsafe.stream.capability.enforce<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span></span><br><span class=\"line\">      Controls whether HBase will check for stream capabilities (hflush/hsync).</span><br><span class=\"line\"></span><br><span class=\"line\">      Disable this if you intend to run on LocalFileSystem, denoted by a rootdir</span><br><span class=\"line\">      with the 'file://' scheme, but be mindful of the NOTE below.</span><br><span class=\"line\"></span><br><span class=\"line\">      WARNING: Setting this to false blinds you to potential data loss and</span><br><span class=\"line\">      inconsistent system state in the event of process and/or node failures. If</span><br><span class=\"line\">      HBase is complaining of an inability to use hsync or hflush it's most</span><br><span class=\"line\">      likely not a false positive.</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>hbase.rootdir</code> 指定hbase数据存储的地方</li>\n<li><code>hbase.zookeeper.property.dataDir</code>zookeeper也需要存储一些文件，该地方是指定zookeeper存储数据的地方</li>\n</ul>\n<h3 id=\"启动测试\">启动测试<a href=\"post/HBase的安装、配置、使用#启动测试\"></a></h3><h4 id=\"运行hbase\">运行hbase<a href=\"post/HBase的安装、配置、使用#运行hbase\"></a></h4><p>运行<code>bin/start-hbase.sh</code>，如果运行成功，使用jps命令可看到<code>HMaster</code>进程启动成功：</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/5c17a9c7e5abff45420b61052e1dabb4d08.jpg\" alt data-zoomable></p></div>\n<p>另外访问<code>&lt;yourip&gt;</code>:16010能看到HBase的管理页面：</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/0ed7f14425e394c198f7e1787a1c16b208a.jpg\" alt data-zoomable></p></div>\n<h4 id=\"使用hbase-shell\">使用hbase shell<a href=\"post/HBase的安装、配置、使用#使用hbase-shell\"></a></h4><p>进入到hbase的安装目录下，使用<code>bin/hbase shell</code>启动hbase：</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/8be1d2df250867239da508ebe3ce3485aca.jpg\" alt data-zoomable></p></div>\n<p>看到:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hbase(main):001:0&gt;</span><br></pre></td></tr></table></figure>\n<p>表示hbase已经启动成功，可以直接使用hbase命令操作了。</p>\n<ul>\n<li><code>create &lt;table&gt; &lt;column family&gt;</code>命令</li>\n</ul>\n<p><code>create &#39;test&#39;, &#39;cf&#39;</code>表示创建一张<code>test</code>的表，column family为<code>cf</code>，创建表的时候table和column family缺一不可。</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/4e8d2e66058ddce18ea0168ac8e2158d439.jpg\" alt data-zoomable></p></div>\n<ul>\n<li><code>list &lt;table&gt;</code> 确认某个表是否存在</li>\n</ul>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/b8c082206ef37aed6b6a47ebd3260f9fd62.jpg\" alt data-zoomable></p></div>\n<ul>\n<li><code>describe &lt;table&gt;</code>查看表的详细信息，包括默认值。</li>\n</ul>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/e8145764688ac35218d2df6d0cbecda50f7.jpg\" alt data-zoomable></p></div>\n<ul>\n<li><code>put &lt;table&gt; &lt;row&gt; &lt;column family&gt; &lt;value&gt;</code> put值到某个表中</li>\n</ul>\n<p>因为HBase使用table/row/column family来确定值的唯一性，所以在put值时，这些信息也是缺一不可的。</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/c7960347621a29b37c74a4f435df0905694.jpg\" alt data-zoomable></p></div>\n<ul>\n<li><code>scan &lt;table&gt;</code> 查看某个表中的数据</li>\n</ul>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/e596318294bb1c0f15326ade6aa13c42997.jpg\" alt data-zoomable></p></div>\n<ul>\n<li><code>get &lt;table&gt; &lt;row&gt;</code> 获取某个表某行的数据</li>\n</ul>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/8202391c8d308e4e5a047fef9e196037913.jpg\" alt data-zoomable></p></div>\n<ul>\n<li><code>disable &lt;table&gt;</code> 禁用表</li>\n</ul>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/2bc916d579ab9c7d13571e7444a7a7a057e.jpg\" alt data-zoomable></p></div>\n<p>如果需要删除表或更改表的设置，需要先使用该命令禁用表，禁用后也可以使用<code>enable &lt;table&gt;</code>来启用表。</p>\n<ul>\n<li><code>enable &lt;table&gt;</code> 启用表</li>\n</ul>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/a2a7faa9472a1d3f2c12c8498294d2722a1.jpg\" alt data-zoomable></p></div>\n<ul>\n<li><code>drop &lt;table&gt;</code> 删除表</li>\n</ul>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/45bae0c003ae3630e6590139a89dfc3a48b.jpg\" alt data-zoomable></p></div>\n<p>最后退出HBase Shell: <code>quit</code></p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/df6b925195942fbd1eb0e0fa2b5f584ec68.jpg\" alt data-zoomable></p></div>\n","prev":{"title":"HBase伪分布式搭建","slug":"HBase伪分布式搭建"},"next":{"title":"Hadoop常用命令","slug":"hadoop相关命令"},"link":"http://wooo.io/post/HBase的安装、配置、使用/"}