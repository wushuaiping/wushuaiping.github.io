{"title":"Hadoop伪分布式搭建","date":"2018-12-28T08:32:58.000Z","slug":"Hadoop伪分布式搭建","comments":true,"tags":["Hadoop"],"updated":"2019-05-11T17:32:17.673Z","content":"<h3 id=\"下载及安装\">下载及安装<a href=\"post/Hadoop伪分布式搭建#下载及安装\"></a></h3><h4 id=\"下载\">下载<a href=\"post/Hadoop伪分布式搭建#下载\"></a></h4><p>我先在CentOS 7.4的服务器的<code>/usr/</code>目录新建了一个hadoop目录，然后进入新建的hadoop目录，下载hadoop。</p>\n<blockquote>\n<p>命令： <code>wget http://mirrors.hust.edu.cn/apache/hadoop/common/hadoop-2.8.5/hadoop-2.8.5.tar.gz</code></p>\n</blockquote>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/a55b1b1de2840bda241f7a97adcd3ee89ba.jpg\" alt data-zoomable></p></div>\n<p>到<a href=\"https://hadoop.apache.org/releases.html\" target=\"_blank\" rel=\"noopener\">hadoop下载页面</a>选择合适的hadoop版本进行下载，我使用的是2.8.5，截止现在，因为hbase最高支持2.8.X的版本，使用Hadoop2.9.X会有问题。</p>\n<h4 id=\"安装\">安装<a href=\"post/Hadoop伪分布式搭建#安装\"></a></h4><p>把下载好的压缩包解压出来</p>\n<blockquote>\n<p>命令：<code>tar xvzf hadoop-2.8.5.tar.gz</code></p>\n</blockquote>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/aaea52fc00178c4f70a2f44e3d9f6c82800.jpg\" alt data-zoomable></p></div>\n<p>配置/etc/profile的JAVA_HOME</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/20c142faef5295b8e4f4dfc36925d051af8.jpg\" alt data-zoomable></p></div>\n<h3 id=\"配置\">配置<a href=\"post/Hadoop伪分布式搭建#配置\"></a></h3><p>配置<code>${HADOOP_HOME}/etc/hadoop/core-site.xml</code></p>\n <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.defaultFS<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://localhost:9000<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/cdc36c1baa03c4f7c10dcd8b425aead4355.jpg\" alt data-zoomable></p></div>\n<p>配置<code>${HADOOP_HOME}/etc/hadoop/hdfs-site.xml</code><br>这个配置是配置HDFS的备份数的，不配置的话默认是备份3分，因为这里是测试，所以1份就够了。一般用默认配置，土豪可以调3+。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"设置passphraseless-ssh\">设置passphraseless ssh<a href=\"post/Hadoop伪分布式搭建#设置passphraseless-ssh\"></a></h3><p>现在通过<code>ssh localhost</code>看看需不需要密码访问。如果发现需要密码访问，那么试用一下命令配置<code>ssh-keygen</code>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -P &apos;&apos; -f ~/.ssh/id_rsa</span><br><span class=\"line\">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class=\"line\">chmod 0600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>\n<h3 id=\"运行\">运行<a href=\"post/Hadoop伪分布式搭建#运行\"></a></h3><ol>\n<li>format namenode</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;HADOOP_HOME&#125;/bin/hdfs namenode -format</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>启动NameNode和DataNode：</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;HADOOP_HOME&#125;/sbin/start-dfs.sh</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>使用jps命令查看是否启动成功：</li>\n</ol>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/f2487c0cd9f0b83f8681a654a063240853b.jpg\" alt data-zoomable></p></div>\n<ol start=\"4\">\n<li>访问localhost:50070</li>\n</ol>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/a2b593e758f11e0e036dc51a7459d1b57eb.jpg\" alt data-zoomable></p></div>\n<h3 id=\"运行官方提供的测试examples\">运行官方提供的测试examples<a href=\"post/Hadoop伪分布式搭建#运行官方提供的测试examples\"></a></h3><ol>\n<li>创建执行MapReduce作业所需的HDFS目录:</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;HADOOP_HOME&#125;/bin/hdfs dfs -mkdir /user</span><br><span class=\"line\">$&#123;HADOOP_HOME&#125;/bin/hdfs dfs -mkdir /user/&lt;username&gt;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>拷贝官方提供的input文件到分布式文件系统中：</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;HADOOP_HOME&#125;/bin/hdfs dfs -put etc/hadoop input</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>运行examples</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;HADOOP_HOME&#125;/bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.8.5.jar grep input output &apos;dfs[a-z.]+&apos;</span><br></pre></td></tr></table></figure>\n<p>跑完会输出这个：</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/53b077055bab2148a4080711d6bf7ab873d.jpg\" alt data-zoomable></p></div>\n<p>最后停止运行：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;HADOOP_HOME&#125;/sbin/stop-dfs.sh</span><br></pre></td></tr></table></figure>\n<h3 id=\"配置YARN\">配置YARN<a href=\"post/Hadoop伪分布式搭建#配置YARN\"></a></h3><p>先配置MapReduce的管理工具为yarn:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp $&#123;HADOOP_HOME&#125;/etc/hadoop/mapred-site.xml.template $&#123;HADOOP_HOME&#125;/etc/hadoop/mapred-site.xml</span><br><span class=\"line\">vim $&#123;HADOOP_HOME&#125;/etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure></p>\n<p>mapred-site.xml配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>配置yarn-site.xml：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim $&#123;HADOOP_HOME&#125;/etc/hadoop/yarn-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mapreduce_shuffle<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>启动yarn：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;HADOOP_HOME&#125;/sbin/start-yarn.sh</span><br><span class=\"line\">jps</span><br><span class=\"line\">32934 NodeManager</span><br><span class=\"line\">32999 Jps</span><br><span class=\"line\">32857 ResourceManager</span><br></pre></td></tr></table></figure></p>\n","prev":{"title":"Hadoop完全分布式集群搭建遇到的一些问题","slug":"Hadoop完全分布式集群搭建遇到的一些问题"},"next":{"title":"Spring boot 2.X启动报错：Specified key was too long; max key length is 1000 bytes","slug":"Spring-boot-2-X启动报错：Specified-key-was-too-long-max-key-length-is-1000-bytes"},"link":"http://wooo.io/post/Hadoop伪分布式搭建/"}