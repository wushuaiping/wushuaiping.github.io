{"title":"记一次docker安装elasticsearch遇到的坑","date":"2018-11-23T07:39:37.000Z","slug":"记一次docker安装elasticsearch及遇到的坑","comments":true,"tags":["docker/elasticsearch"],"updated":"2019-05-11T17:11:39.047Z","content":"<h4 id=\"先给一行命令\">先给一行命令<a href=\"post/记一次docker安装elasticsearch及遇到的坑#先给一行命令\"></a></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 9200:9200 -p 9300:9300 -e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot; --name=&lt;your es name&gt; elasticsearch:&lt;es version&gt;</span><br></pre></td></tr></table></figure>\n<p>使用该命令可直接安装并运行es的docker 镜像容器</p>\n<h4 id=\"问题\">问题<a href=\"post/记一次docker安装elasticsearch及遇到的坑#问题\"></a></h4><p>使用命令<code>linux docker run -d -p 9200:9200 -p 9300:9300 --name=&lt;your es name&gt; elasticsearch:&lt;es version&gt;</code>启动, 然后想看是否启动起来了，于是使用<code>docker ps</code>命令发现:</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/09439d4ed2e777d03f84041aa784d239f28.jpg\" alt data-zoomable></p></div>\n<p>es并未启动起来。</p>\n<p>于是又用<code>docker ps -a</code>命令:</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/a3ee3ae3727b115a12ac866c0060ae7c445.jpg\" alt data-zoomable></p></div>\n<p>发现启动终止了。</p>\n<p>然后用<code>docker logs -f &lt;container id&gt;</code>命令查看es的启动日志:</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/c33be73cf604e7e7484084921d85fc6bf61.jpg\" alt data-zoomable></p></div>\n<p>拉到最下面:</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/7a52b9fdff0839df2590a72c5683874bcf0.jpg\" alt data-zoomable></p></div>\n<p>长这样:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">power management:</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Memory: 4k page, physical 1882892k(89076k free), swap 0k(0k free)</span><br><span class=\"line\"></span><br><span class=\"line\">vm_info: OpenJDK 64-Bit Server VM (25.181-b13) for linux-amd64 JRE (1.8.0_181-8u181-b13-2~deb9u1-b13), built on Oct 22 2018 18:05:23 by &quot;pbuilder&quot; with gcc 6.3.0 20170516</span><br><span class=\"line\"></span><br><span class=\"line\">time: Fri Nov 23 07:00:34 2018</span><br><span class=\"line\">elapsed time: 0 seconds (0d 0h 0m 0s)</span><br></pre></td></tr></table></figure></p>\n<p>于是复制报错信息Google一波，发现问题所在。elasticsearch5.+配置默认的内存是2g。我给docker的内存也只有2g，于是就GG了。</p>\n<p>删除了旧容器，和旧镜像后，在docker启动命令中加上<code>-e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</code>解决问题</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/7e40ce439a78a2b93da7e8296cb39703f5b.jpg\" alt data-zoomable></p></div>\n<p><code>docker ps</code> :</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/85e67312cd5cdcece359c5a0a00d34e57d6.jpg\" alt data-zoomable></p></div>\n<p>最后访问一波9200端口：</p>\n<div class=\"article-img\"><p><img src=\"https://oscimg.oschina.net/oscnet/83f0a8689a6ab5b8ffb20d0212005b6fb6c.jpg\" alt data-zoomable></p></div>\n<p>OJBK</p>\n","prev":{"title":"spring boot 2.x data redis 的简单使用","slug":"spring-boot-2-x-data-redis-的简单使用"},"next":{"title":"nexus3 搭建遇到的一些问题","slug":"nexus3-搭建遇到的一些问题"},"link":"http://wooo.io/post/记一次docker安装elasticsearch及遇到的坑/"}