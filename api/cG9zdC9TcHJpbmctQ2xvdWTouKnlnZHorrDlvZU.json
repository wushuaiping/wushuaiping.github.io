{"title":"Spring Cloud踩坑记录","date":"2018-04-24T02:24:16.000Z","slug":"Spring-Cloud踩坑记录","comments":true,"tags":["Spring Cloud"],"updated":"2019-05-11T17:11:10.278Z","content":"<h3 id=\"报错-Whitelabel-Error-Page\">报错 Whitelabel Error Page<a href=\"post/Spring-Cloud踩坑记录#报错-Whitelabel-Error-Page\"></a></h3><p>原因是把Application.java放在了如下所示：</p>\n<div class=\"article-img\"><p><img src=\"https://static.oschina.net/uploads/img/201804/24103845_2ayg.png\" alt=\"Whitelabel Error Page\" title=\"Whitelabel Error Page\" data-zoomable></p></div>\n<p>解决： 把Application.java放到最外层即可解决</p>\n<div class=\"article-img\"><p><img src=\"https://static.oschina.net/uploads/img/201804/24103944_B3YL.png\" alt=\"输入图片说明\" title=\"在这里输入图片标题\" data-zoomable></p></div>\n<h3 id=\"启动报错ClassNotFoundException-feign-Feign-Builder\">启动报错ClassNotFoundException: feign.Feign$Builder<a href=\"post/Spring-Cloud踩坑记录#启动报错ClassNotFoundException-feign-Feign-Builder\"></a></h3><p>原因： 包的问题。<br>解决方案, 修改pom文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;properties&gt;</span><br><span class=\"line\">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class=\"line\">    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</span><br><span class=\"line\">    &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class=\"line\">&lt;/properties&gt;</span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;version&gt;1.2.3&lt;/version&gt;</span><br><span class=\"line\">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;scope&gt;compile&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;version&gt;Camden.SR4&lt;/version&gt;</span><br><span class=\"line\">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">        &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br><span class=\"line\">&lt;build&gt;</span><br><span class=\"line\">    &lt;plugins&gt;</span><br><span class=\"line\">        &lt;plugin&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;/plugin&gt;</span><br><span class=\"line\">    &lt;/plugins&gt;</span><br><span class=\"line\">&lt;/build&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"搭建Spring-Cloud-Bus-Demo时，启动报错。\">搭建Spring Cloud Bus Demo时，启动报错。<a href=\"post/Spring-Cloud踩坑记录#搭建Spring-Cloud-Bus-Demo时，启动报错。\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Caused by: java.lang.NoClassDefFoundError: org/springframework/security/config/http/SessionCreationPolicy</span><br><span class=\"line\">\tat org.springframework.boot.actuate.autoconfigure.ManagementServerProperties$Security.&lt;init&gt;(ManagementServerProperties.java:186) ~[spring-boot-actuator-1.4.0.RELEASE.jar:1.4.0.RELEASE]</span><br><span class=\"line\">\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:1.8.0_162]</span><br><span class=\"line\">\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) ~[na:1.8.0_162]</span><br><span class=\"line\">\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[na:1.8.0_162]</span><br><span class=\"line\">\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423) ~[na:1.8.0_162]</span><br><span class=\"line\">\tat java.lang.Class.newInstance(Class.java:442) ~[na:1.8.0_162]</span><br><span class=\"line\">\tat org.springframework.beans.BeanUtils.instantiate(BeanUtils.java:77) ~[spring-beans-4.3.2.RELEASE.jar:4.3.2.RELEASE]</span><br><span class=\"line\">\tat org.springframework.beans.AbstractNestablePropertyAccessor.newValue(AbstractNestablePropertyAccessor.java:914) ~[spring-beans-4.3.2.RELEASE.jar:4.3.2.RELEASE]</span><br><span class=\"line\">\t... 125 common frames omitted</span><br></pre></td></tr></table></figure>\n<p>报错信息如图所示：<br><img src=\"https://static.oschina.net/uploads/img/201804/24104117_PhV5.png\" alt=\"输入图片说明\" title=\"在这里输入图片标题\"><br>出错原因：<br> 因为没有找到该类。所以就出现这个问题，因为我们在配置消息总线时加入了该配置：<code>management.security.enable=false</code>，该配置需要对<code>Spring</code>的<code>security</code>包产生依赖。但在项目<code>pom</code>中并没有去依赖<code>Spring</code>的<code>security</code>包。</p>\n<p>解决方案：<br> 在pom文件中增加对security包的依赖：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 对Spring security安全包的依赖，否则会报错 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-security<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"报错：\">报错：<a href=\"post/Spring-Cloud踩坑记录#报错：\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DiscoveryClient_SPRINGCLOUD-QUERYDSL/10.0.2.140:springcloud-querydsl:4445 - was unable to refresh its cache! status = Cannot execute request on any known server</span><br></pre></td></tr></table></figure>\n<p>原因：<br>没有启动注册中心，导致服务无法进行注册，所以会报Cannot execute request on any known server<br>解决方案：<br>启动注册中心</p>\n<h3 id=\"报错：-1\">报错：<a href=\"post/Spring-Cloud踩坑记录#报错：-1\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">org.hibernate.MappingException: Could not determine type for: java.util.List, at table: teacher, for columns: [org.hibernate.mapping.Column(students)]</span><br></pre></td></tr></table></figure>\n<p>原因：<br>因为<code>Teacher</code>与<code>Student</code>是一对多关系，在<code>Teacher</code>里面有<code>List&lt;Student&gt;</code>这么一个引用，所以需要指定它们之间的关系、比如@OneToMany、@ManyToOne等。<br>解决方案：<br>指定相应的关系即可。</p>\n","prev":{"title":"centos 7+ 暴露端口给外网","slug":"centos-7-暴露端口给外网"},"next":{"title":"正则表达式入门常用元字符","slug":"正则表达式入门常用元字符"},"link":"http://wooo.io/post/Spring-Cloud踩坑记录/"}