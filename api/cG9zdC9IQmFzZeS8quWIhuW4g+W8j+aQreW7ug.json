{"title":"HBase伪分布式搭建","date":"2019-01-02T08:32:58.000Z","slug":"HBase伪分布式搭建","comments":true,"tags":["Hbase"],"updated":"2019-05-11T17:06:05.350Z","content":"<ul>\n<li>之前把hbase安装配置好了–&gt;<a href=\"http://note.youdao.com/noteshare?id=775ab088d00826bebef451dcafdce18d\" target=\"_blank\" rel=\"noopener\">HBase的安装、配置、使用</a>，现在开始进行伪分布式的搭建。</li>\n</ul>\n<h3 id=\"配置hbase-site-xml\">配置hbase-site.xml<a href=\"post/HBase伪分布式搭建#配置hbase-site-xml\"></a></h3><p>在原有的hbase-site.xml配置的基础上增加以下配置，该配置指示HBase以分布式模式运行，每个HBase相关的进程都是单独的JVM实例：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.cluster.distributed<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>然后需要设置<code>hbase.unsafe.stream.capability.enforce</code>为true，之前设置的false：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.rootdir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://localhost:9000/hbase<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.zookeeper.property.dataDir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/hadoop/hbase/zookeeper<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.unsafe.stream.capability.enforce<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span> <span class=\"comment\">&lt;!--需要更改这个位置为true--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span></span><br><span class=\"line\">      Controls whether HBase will check for stream capabilities (hflush/hsync).</span><br><span class=\"line\"></span><br><span class=\"line\">      Disable this if you intend to run on LocalFileSystem, denoted by a rootdir</span><br><span class=\"line\">      with the 'file://' scheme, but be mindful of the NOTE below.</span><br><span class=\"line\"></span><br><span class=\"line\">      WARNING: Setting this to false blinds you to potential data loss and</span><br><span class=\"line\">      inconsistent system state in the event of process and/or node failures. If</span><br><span class=\"line\">      HBase is complaining of an inability to use hsync or hflush it's most</span><br><span class=\"line\">      likely not a false positive.</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!--表示以分布式模式运行--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hbase.cluster.distributed<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"HBase的进程\">HBase的进程<a href=\"post/HBase伪分布式搭建#HBase的进程\"></a></h3><h4 id=\"运行HBase\">运行HBase<a href=\"post/HBase伪分布式搭建#运行HBase\"></a></h4><p>使用<code>bin/start-hbase.sh</code>命令运行HBase，运行成功后，使用jps命令查看到以下以H开头的JVM进场则代表HBase伪分布模式启动成功：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@VM_0_14_centos hbase-2.1.1]# jps</span><br><span class=\"line\">3034 NameNode</span><br><span class=\"line\">13093 HMaster</span><br><span class=\"line\">13168 HRegionServer</span><br><span class=\"line\">14668 Jps</span><br><span class=\"line\">3350 SecondaryNameNode</span><br><span class=\"line\">3152 DataNode</span><br><span class=\"line\">13030 HQuorumPeer</span><br></pre></td></tr></table></figure>\n<h4 id=\"查看在HDFS中的HBase目录\">查看在HDFS中的HBase目录<a href=\"post/HBase伪分布式搭建#查看在HDFS中的HBase目录\"></a></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@VM_0_14_centos hbase-2.1.1]# /usr/hadoop/hadoop-2.8.5/bin/hadoop fs -ls /hbase</span><br><span class=\"line\">Found 14 items</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 14:58 /hbase/.hbck</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 15:43 /hbase/.tmp</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 15:43 /hbase/MasterProcWALs</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 15:43 /hbase/WALs</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 15:51 /hbase/archive</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 14:58 /hbase/corrupt</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 14:58 /hbase/data</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 15:04 /hbase/default</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 14:58 /hbase/hbase</span><br><span class=\"line\">-rw-r--r--   3 root supergroup         42 2019-01-02 14:58 /hbase/hbase.id</span><br><span class=\"line\">-rw-r--r--   3 root supergroup          7 2019-01-02 14:58 /hbase/hbase.version</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 14:58 /hbase/mobdir</span><br><span class=\"line\">drwxr-xr-x   - root supergroup          0 2019-01-02 15:53 /hbase/oldWALs</span><br><span class=\"line\">drwx--x--x   - root supergroup          0 2019-01-02 14:58 /hbase/staging</span><br></pre></td></tr></table></figure>\n","prev":{"title":"Spark安装 配置 使用","slug":"Spark安装、配置、使用"},"next":{"title":"HBase的安装、配置、使用","slug":"HBase的安装、配置、使用"},"link":"http://wooo.io/post/HBase伪分布式搭建/"}